<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<title>转盘抽奖</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<link type="text/css" rel="stylesheet" href="style/normalize.css">
<link type="text/css" rel="stylesheet" href="style/box.css">
<link type="text/css" rel="stylesheet" href="style/wapframe.css">
<link type="text/css" rel="stylesheet" href="style/index.css">
</head>
<body>
<!--演示内容开始--> 
<header class="mBxCm">
        <div class="mFlex1">京味儿好礼免费送，精美礼品就等你来！</div>
</header>
<div class="borderBm marginBm10">
    <section class="topmsg">
        <div>
            <article id="teltitle">输入您的手机号点击开始即可参与抽奖</article>
            <input type="tel" placeholder="请输入手机号" class="telbox" id="tel" maxlength="11">
        </div>
        <div>
            <article class="">您的手机号为<span class="red" id="showtel"></span></article>
            <article class="">您还有 <span class="red" id="inmboer">2</span> 次抽奖机会</article>
        </div>
    </section>
</div>
<div class="warpbox borderBm">
    <div class="warpZhuanpan">
        <img src="images/zhuanpan.png" id="zhuanpan" class="bgpice" width="100%">
        <img src="images/zhizhen.png" class="pinot" width="100%">
        <input class="zhuanpanbtn" type="button" value="抽奖">
        <input class="relottery" type="button" value="在抽一次" >
    </div>
</div>
<div class="warpbox borderBm" id="zjjg"></div>
<div class="warpbox borderBm cjlc">
    <h2>抽奖流程：</h2>
    <h3>1）.关注公众账号“六合顺”</h3>
    <h3>2）.每个用户每日只有三次抽奖机会</h3>
    <h3>3）.个人中心可查看获得奖品</h3>
    <h2> 奖品兑换：</h2>
    <h3>1）.本活动不与其他卡和优惠共享；</h3>
    <h3>2）.本优惠每桌只限使用一次；</h3>
    <h3>3）.本优惠不兑现，过期作废，使用期限为抽奖当月使用；</h3>
    <h3>4）.本优惠仅限六合顺店使用；</h3>
    <h3>5）.本优惠仅限堂食使用（法定假日不可使用）。</h3>
</div>
<!--演示内容结束-->
<script src="script/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
var swicht = true;//防止重复按按钮
var a;//转6圈后再转的角度
var msgs;//展示结果变量
var switchEq=3;
/**随机数函数**/
function fRandomBy(under, over) {
    switch (arguments.length) {
        case 1:
            return parseInt(Math.random() * under + 1);
        case 2:
            return parseInt(Math.random() * (over - under + 1) + under);
        default:
            return 0;
    }
}
/**点击执行转动**/
$(".zhuanpanbtn").click(function(){
    var telTest=$("#tel").val();
    var telRet=/^1[3-8]+\d{9}$/;
    if(telRet.test(telTest)){
         lottery();
         $("#teltitle").removeClass("fontred"); 
         $(".topmsg div:eq(0)").hide();
         $(".topmsg div:eq(1)").show().find("#showtel").html(telTest);
    }else{
         $("#teltitle").addClass("fontred"); 
         alert("手机号码错误");
    }
});
function lottery() {
    if (swicht) {
        $(".bgpice").addClass("rotaclass");
        var randoms = [1, 2, 3, 4, 5, 6, 7, 8];
        var ovs = fRandomBy(0,7);
        var arrValue = randoms[ovs];
        var rotate = 2160;
        //alert(arrValue);
        if (arrValue === 1) {
            a = fRandomBy(5,40);
            
            msgs="<h1 class='alerttitle'>感谢参与，继续努力哟！</h1>";
        } else if (arrValue === 2) {
            a = fRandomBy(50,85);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【果仁菠菜】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        } else if (arrValue === 3) {
            a = fRandomBy(95,130);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【烤鸡翅】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        } else if (arrValue === 4) {
            a = fRandomBy(140, 175);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【棉花糖】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        } else if (arrValue === 5) {
            a = fRandomBy(185,220);
            msgs="<h1 class='alerttitle'>感谢参与，继续努力吧！</h1>";
        } else if (arrValue === 6) {
            a = fRandomBy(230,265);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【西洋大拌菜】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        } else if (arrValue === 7) {
            a = fRandomBy(275,310);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【羊肉串】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        } else if (arrValue === 8) {
            a = fRandomBy(320,355);
            msgs="<h1 class='alerttitle'>恭喜您中奖了</h1>您已获得 【油酥海带】 一份，请到店后出示中奖信息领奖。（中奖信息可在<a href='#' class='colorred'>个人中心</a>查看)";
        }
       $("#try").val(arrValue);
        var endRote = rotate + a;
        $(".rotaclass").css({
            "-webkit-transform": "rotate(" + endRote + "deg)",
            "transform": "rotate(" + endRote + "deg)"
        });
        $(".pinot").attr("src","images/cjz.png");
        $(".relottery").hide();
        $("#zjjg").html("").fadeOut();
        setTimeout(function() {
              switchEq--;
            $(".relottery").show();
            //alert(msgs)
            $("#zjjg").html(msgs).fadeIn();
            $(".pinot").attr("src","images/zaichouyici.png");
            $(".topmsg div:eq(1)").show().find("#inmboer").html(switchEq);
            
            
            if(switchEq===0){
                $(".pinot").attr("src","images/mtjx.png");
                $(".warpZhuanpan").css({opacity: 0.5});
            }

        }, 7000);
        swicht = false;
    }
}
$(".relottery").bind("click", function() {
    if($("#inmboer").html()!=="0"){
    $(".bgpice").removeClass("rotaclass").removeAttr("style");
    swicht = true;
   $(this).hide();
   setTimeout(function() {lottery();  }, 10);
    }else{
       $("#zjjg").html("<h1 class='alerttitle'>今日抽奖次数已用完</h1>欢迎明天继续");
       $(".pinot").attr("src","images/mtjx.png");
       $(".warpZhuanpan").css({opacity: 0.5});
       $(".bgpice").removeClass("rotaclass").removeAttr("style");
    }
});
       
</script>
</body>
</html>
